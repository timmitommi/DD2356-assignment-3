import numpy as np

x = [8,16,32,64,128,256,512,1024,2048,4096,8192,16384,32768,65536,131072]
y_intra = [0.000000594,0.000000622,0.000000696,0.000000734,0.000000756,0.000000768,0.000000787,0.000000999,0.000001173,0.000001688,0.000003695,0.000004356,0.000006824,0.000011466,0.00002388]

y_inter = [0.000001435,0.00000149,0.000001438,0.00000144,0.00000129,0.000001493,0.0000016,0.000001645,0.000002215,0.000003114,0.000005,0.000005538,0.000007453,0.000011568,0.000019171]

p1_intra,p2_intra = np.polyfit(x,y_intra,1)

p1_inter,p2_inter = np.polyfit(x,y_inter,1)

print(f"Intra node: \nLatency: {p2_intra/1e-6} us\nBandwidth: {1/p1_intra/1e9} GB/s")
print()
print(f"Inter node: \nLatency: {p2_inter/1e-6} us\nBandwidth: {1/p1_inter/1e9} GB/s")